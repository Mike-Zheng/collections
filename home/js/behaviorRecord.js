define("behaviorRecord",function(require,exports,module){var e,t,a,i,o="https://statis".concat(ENV,".591.com.tw/visit/record"),n=!1,r={device:"",type:0,post_id:0},c={deep:1,browse_time:0},f=[{key:"image",pcBehavior:"data-behavior-img",touchBehavior:"img",value:!1},{key:"list_image",pcBehavior:"data-behavior-imglist",touchBehavior:"list-img",value:!1},{key:"fav",pcBehavior:"data-behavior-collect",touchBehavior:"collect",value:!1},{key:"share",pcBehavior:"data-behavior-share",touchBehavior:"share",value:!1},{key:"call",pcBehavior:"data-behavior-call",touchBehavior:"call",value:!1},{key:"friend",pcBehavior:"data-behavior-friend",touchBehavior:"friend",value:!1},{key:"question",pcBehavior:"data-behavior-question",touchBehavior:"question",value:!1},{key:"print",pcBehavior:"data-behavior-print",touchBehavior:"print",value:!1},{key:"address",pcBehavior:"data-behavior-map",touchBehavior:"address",value:!1},{key:"message",pcBehavior:"data-behavior-message",touchBehavior:"message",value:!1}],d={rent:1,sale:2,store:6},m=["body","html","#document"];function h(){"pc"===r.device?(window.addEventListener("beforeunload",function(){v("beacon")}),window.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&v("fetch")}),window.addEventListener("mousemove",function(e){e.clientY-10<=0&&v("fetch")})):(window.addEventListener("pagehide",function(){v("beacon")}),window.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&v("fetch")}))}function v(e){var t,a;n&&"fetch"===e||(a=new FormData,f.forEach(function(e){a.append(e.key,+e.value)}),Object.keys(c).forEach(function(e){a.append(e,c[e])}),Object.keys(r).forEach(function(e){a.append(e,r[e])}),t=a,"beacon"===e&&navigator.sendBeacon(o,t),"fetch"===e&&(fetch(o,{method:"POST",body:t,credentials:"include"}),n=!0,setTimeout(function(){n=!1},1e3)),f.forEach(function(e){e.value=!1}),Object.assign(c,{deep:1,browse_time:0}))}r.device=/Mobi|Android|iPhone/i.test(navigator.userAgent)?"touch":"pc","pc"===r.device?r.type=d[document.location.host.split(".")[0]]:(t=(e=document.location.pathname.replace("mobile-detail","store").match(/(rent|sale|store)/))?e[0]:"",r.type=d[t]||0),"pc"===r.device?(a=document.location.pathname.match(/\d{5,}/),r.post_id=a?a[0]:0):(i=(r.type<=2?document.location.pathname:document.location.search).match(/\d{5,}/),r.post_id=i?i[0]:0),document.body.addEventListener("click",function(e){var t=e.path.filter(function(e){return e.nodeName&&!m.includes(e.nodeName.toLocaleLowerCase())}),a=!0,i=!1,o=void 0;try{for(var n,r=t[Symbol.iterator]();!(a=(n=r.next()).done);a=!0){var c=n.value,d=!1,h=!0,v=!1,l=void 0;try{for(var u,s=f[Symbol.iterator]();!(h=(u=s.next()).done);h=!0){var p=u.value;if(c.hasAttribute(p.pcBehavior)||c.getAttribute("data-behavior")===p.touchBehavior){d=p.value=!0;break}}}catch(e){v=!0,l=e}finally{try{h||null==s.return||s.return()}finally{if(v)throw l}}if(d)break}}catch(e){i=!0,o=e}finally{try{a||null==r.return||r.return()}finally{if(i)throw o}}},!0),window.addEventListener("scroll",function(){var e=1+Math.ceil(window.scrollY/window.outerHeight);c.deep=e>c.deep?e:c.deep}),setInterval(function(){"visible"===document.visibilityState&&(c.browse_time+=2e3)},2e3),h()});